# 快速參考

## 🎯 系統已改進

### 最新更新（2024-11-24）

✅ **支援包含額外欄位的 Excel 檔案**
- 您的 Excel 可以有任意數量的欄位
- 系統會自動提取需要的欄位，忽略其他欄位
- 欄位順序不重要

✅ **更詳細的錯誤訊息**
- 系統會顯示 Excel 中有哪些欄位
- 會警告缺少哪些建議的欄位
- 提供更友善的錯誤說明

✅ **更好的日誌輸出**
- 後端會顯示詳細的處理過程
- 可以在終端機看到每一步的執行情況

---

## 📋 必要欄位

系統需要以下欄位（欄位名稱必須完全一致）：

### 核心欄位
- **年級** - 用於分組（必填）
- **家長姓名** - 用於判斷手足關係（必填）

### 建議欄位
- 兒童姓名
- 性別
- 學校
- 家長行動電話

### 選填欄位
- 報名序號
- 備註

---

## 💡 使用提示

### 1. Excel 準備

您的 Excel 可以是這樣：

```
報名日期 | 報名序號 | 兒童姓名 | 性別 | 年級 | 學校 | 身分證字號 | 家長姓名 | 家長行動電話 | 繳費狀態 | 備註
```

系統會自動：
- ✅ 提取需要的欄位
- ⏭️ 忽略額外的欄位（報名日期、身分證字號、繳費狀態等）

### 2. 上傳檔案

1. 開啟 http://localhost:5173
2. 點擊「選擇檔案」
3. 選擇您的 Excel 檔案
4. 點擊「上傳並處理」

### 3. 查看日誌

在後端終端機（運行 `npm run dev` 的視窗）可以看到：

```
讀取到 50 筆資料
Excel 中的欄位: ['報名日期', '報名序號', '兒童姓名', ...]
警告：缺少以下欄位: []
建立分頁: 一年級, 共 15 筆資料
建立分頁: 二年級, 共 18 筆資料
處理完成
```

### 4. 下載結果

處理完成後，點擊「下載整理後的 Excel」

---

## 🔍 常見情況

### 情況 1：Excel 有很多額外欄位

**問題**: 我的 Excel 有 20 個欄位，但系統只需要 8 個

**解答**: ✅ 沒問題！直接上傳即可，系統會自動提取需要的欄位

---

### 情況 2：欄位順序不同

**問題**: 我的「年級」欄位在最後面，不在前面

**解答**: ✅ 沒問題！欄位順序不重要，系統依照欄位名稱識別

---

### 情況 3：缺少某些欄位

**問題**: 我的 Excel 沒有「報名序號」欄位

**解答**: ✅ 沒問題！系統會顯示警告但仍會處理，該欄位會是空值

---

### 情況 4：欄位名稱不同

**問題**: 我的欄位叫「學生姓名」而不是「兒童姓名」

**解答**: ⚠️ 需要修改！請將欄位名稱改為「兒童姓名」，或修改程式碼

---

## 🚨 錯誤處理

### 錯誤：500 - Internal Server Error

**可能原因**:
1. Excel 檔案格式錯誤
2. 檔案損壞
3. 必要欄位缺失

**解決方法**:
1. 查看後端終端機的詳細錯誤訊息
2. 確認檔案是 .xlsx 或 .xls 格式
3. 確認檔案沒有損壞
4. 確認有「年級」和「家長姓名」欄位

### 查看詳細錯誤

後端終端機會顯示：
```
處理 Excel 時發生錯誤: Error: ...
錯誤詳情: ...
錯誤堆疊: ...
```

這些資訊可以幫助您找出問題所在。

---

## 📚 詳細文件

| 文件 | 說明 |
|------|------|
| `欄位說明.md` | 詳細的欄位說明和範例 |
| `EXAMPLE_DATA.md` | Excel 範例資料格式 |
| `SYSTEM_FLOW.md` | 系統流程詳細說明 |
| `測試資料說明.md` | 如何建立測試資料 |

---

## 🎯 測試建議

### 第一次使用

1. 建立簡單的測試 Excel（只包含必要欄位）
2. 上傳並測試
3. 確認結果正確

### 正式使用

1. 使用完整的 Excel（包含所有欄位）
2. 查看後端日誌確認處理過程
3. 檢查輸出結果

---

## 📞 需要協助？

1. **查看後端日誌** - 最重要的除錯資訊
2. **閱讀 `欄位說明.md`** - 詳細的欄位說明
3. **檢查 Excel 欄位名稱** - 確保名稱完全一致

---

## 🎉 系統優勢

✅ **靈活**: 支援任意欄位數量和順序
✅ **智能**: 自動提取需要的資料
✅ **友善**: 詳細的錯誤訊息和日誌
✅ **可靠**: 完整的錯誤處理機制

現在可以放心上傳您的 Excel 檔案了！
